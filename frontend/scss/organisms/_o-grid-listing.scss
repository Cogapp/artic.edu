/***

Basic flexed set up

***/

.o-grid-listing {
  display: flex;
  position: relative;
  flex-flow: row wrap;
  margin-top: 28px;

  &:first-child {
    margin-top: 0;
  }

  @include breakpoint('small+') {
    margin-top: 36px;

    &:first-child {
      margin-top: 0;
    }
  }

  @include breakpoint('medium+') {
    margin-top: 40px;

    &:first-child {
      margin-top: 0;
    }
  }
}

.o-grid-listing > * {
  position: relative;
  flex: 0 0 auto;
  width: 100%;

  @each $name, $point in $breakpoints {
    @include breakpoint('#{$name}') {
      margin-top: #{map-get($grid-margin-tops, $name)}px;
    }
  }
}

.o-grid-listing > *:first-child {
  @each $name, $point in $breakpoints {
    @include breakpoint('#{$name}') {
      margin-top: 0;
    }
  }
}

// if this is in cols, adjust spacings
@each $name, $point in $breakpoints {
  @include breakpoint('#{$name}') {
    .o-grid-listing[class*="col@#{$name}"] {
      margin-left: colspan(2, #{$name}, 0, true);
    }

    .o-grid-listing[class*="col@#{$name}"] > * {
      margin-top: 0;
      margin-left: colspan(2, #{$name});
      border-top: 0 none;
    }
  }
}

/***

Variant: `o-listing--single-row` - limits to a single row

***/

.o-grid-listing--single-row {
  flex-wrap: nowrap;
}

@each $name, $point in $breakpoints {
  @include breakpoint('#{$name}') {
    .o-grid-listing--single-row[class*="scroll@#{$name}"] {
      @if ($name == 'xxlarge') {
        width: calc(#{colspan(43, xxlarge)} + ((100vw - #{map-get($main-col-widths, xxlarge)}) / 2));
        margin-right: calc((100vw - #{map-get($main-col-widths, xxlarge)}) / -2);
        margin-left: colspan(2, xxlarge);
        padding-left: 0;
      } @else {
        margin-right: colspan(3, $name, 0, true);
        margin-left: colspan(3, $name, 0, true);
        padding-left: colspan(1, $name);
      }
      overflow-x: auto;
      overflow-y: hidden;
      cursor: ew-resize;
      -ms-overflow-style: none;
      overflow-y: -moz-scrollbars-none;
      -webkit-overflow-scrolling: touch;

      &::-webkit-scrollbar {
        -webkit-appearance: none;
        display: none;
      }
    }

    .o-grid-listing--single-row[class*="scroll@#{$name}"]::after {
      content: '';
      display: block;
      flex: 0 0 auto;
      @if ($name == 'xxlarge') {
        width: calc((100vw - #{map-get($main-col-widths, xxlarge)}) / 2);
      } @else {
        width: colspan(3, $name);
      }
      height: 1px;
    }

    .o-grid-listing--single-row[class*="scroll@#{$name}"] > * {
      width: 216px;
      margin-top: 0;
      margin-left: colspan(2, #{$name});
      border-top: 0 none;

      @if ($name == 'xxlarge') {
        &:first-child {
          margin-left: 0;
        }
      }

    }
  }
}

/***

Following a <hr>

***/

hr + .o-grid-listing {
  @each $name, $point in $breakpoints {
    @include breakpoint('#{$name}') {
      margin-top: 0;
      padding-top: #{map-get($grid-margin-tops, $name)}px;
    }
  }
}

@each $name, $point in $breakpoints {
  @include breakpoint('#{$name}') {
    hr + .o-grid-listing--gridlines-top[class*="col@#{$name}"],
    hr + .o-grid-listing--gridlines-rows[class*="col@#{$name}"] {
      padding-top: 0;
    }
  }
}


/***

Variants: `.o-grid-listing--X-col\@XXXXX`

X cols at XXXXX breakpoint

***/

// adjust width of things, second row onwards wants margin-tops

@include breakpoint('small') {
  .o-grid-listing--2-col\@small > * {
    width: colspan(grid-cols-to-colspan(2), 'small');
  }

  .o-grid-listing--3-col\@small > * {
    width: colspan(grid-cols-to-colspan(3), 'small');
  }

  .o-grid-listing--2-col\@small:not(.o-grid-listing--single-row) > *:nth-child(2) ~ *,
  .o-grid-listing--3-col\@small:not(.o-grid-listing--single-row) > *:nth-child(3) ~ * {
    margin-top: #{map-get($grid-margin-tops, 'small')}px;
  }

  .o-grid-listing--single-row.o-grid-listing--hide-extra\@small.o-grid-listing--2-col\@small > *:nth-child(2) ~ *,
  .o-grid-listing--single-row.o-grid-listing--hide-extra\@small.o-grid-listing--3-col\@small > *:nth-child(3) ~ * {
    display: none;
  }
}

@include breakpoint('medium') {
  .o-grid-listing--2-col\@medium > * {
    width: colspan(grid-cols-to-colspan(2), 'medium');
  }

  .o-grid-listing--3-col\@medium > * {
    width: colspan(grid-cols-to-colspan(3), 'medium');
  }

  .o-grid-listing--4-col\@medium > * {
    width: colspan(grid-cols-to-colspan(4), 'medium');
  }

  .o-grid-listing--2-col\@medium:not(.o-grid-listing--single-row) > *:nth-child(2) ~ *,
  .o-grid-listing--3-col\@medium:not(.o-grid-listing--single-row) > *:nth-child(3) ~ *,
  .o-grid-listing--4-col\@medium:not(.o-grid-listing--single-row) > *:nth-child(4) ~ * {
    margin-top: #{map-get($grid-margin-tops, 'medium')}px;
  }

  .o-grid-listing--single-row.o-grid-listing--hide-extra\@medium.o-grid-listing--2-col\@medium > *:nth-child(2) ~ *,
  .o-grid-listing--single-row.o-grid-listing--hide-extra\@medium.o-grid-listing--3-col\@medium > *:nth-child(3) ~ *,
  .o-grid-listing--single-row.o-grid-listing--hide-extra\@medium.o-grid-listing--4-col\@medium > *:nth-child(4) ~ * {
    display: none;
  }
}

@include breakpoint('large') {
  .o-grid-listing--2-col\@large > * {
    width: colspan(grid-cols-to-colspan(2), 'large');
  }

  .o-grid-listing--3-col\@large > * {
    width: colspan(grid-cols-to-colspan(3), 'large');
  }

  .o-grid-listing--4-col\@large > * {
    width: colspan(grid-cols-to-colspan(4), 'large');
  }

  .o-grid-listing--5-col\@large > * {
    width: colspan(grid-cols-to-colspan(5), 'large');
  }

  .o-grid-listing--2-col\@large:not(.o-grid-listing--single-row) > *:nth-child(2) ~ *,
  .o-grid-listing--3-col\@large:not(.o-grid-listing--single-row) > *:nth-child(3) ~ *,
  .o-grid-listing--4-col\@large:not(.o-grid-listing--single-row) > *:nth-child(4) ~ *,
  .o-grid-listing--5-col\@large:not(.o-grid-listing--single-row) > *:nth-child(5) ~ * {
    margin-top: #{map-get($grid-margin-tops, 'large')}px;
  }

  .o-grid-listing--single-row.o-grid-listing--hide-extra\@large.o-grid-listing--2-col\@large > *:nth-child(2) ~ *,
  .o-grid-listing--single-row.o-grid-listing--hide-extra\@large.o-grid-listing--3-col\@large > *:nth-child(3) ~ *,
  .o-grid-listing--single-row.o-grid-listing--hide-extra\@large.o-grid-listing--4-col\@large > *:nth-child(4) ~ *,
  .o-grid-listing--single-row.o-grid-listing--hide-extra\@large.o-grid-listing--4-col\@large > *:nth-child(4) ~ * {
    display: none;
  }
}

@include breakpoint('xlarge') {
  .o-grid-listing--2-col\@xlarge > * {
    width: colspan(grid-cols-to-colspan(2), 'xlarge');
  }

  .o-grid-listing--3-col\@xlarge > * {
    width: colspan(grid-cols-to-colspan(3), 'xlarge');
  }

  .o-grid-listing--4-col\@xlarge > * {
    width: colspan(grid-cols-to-colspan(4), 'xlarge');
  }

  .o-grid-listing--5-col\@xlarge > * {
    width: colspan(grid-cols-to-colspan(5), 'xlarge');
  }

  .o-grid-listing--2-col\@xlarge:not(.o-grid-listing--single-row) > *:nth-child(2) ~ *,
  .o-grid-listing--3-col\@xlarge:not(.o-grid-listing--single-row) > *:nth-child(3) ~ *,
  .o-grid-listing--4-col\@xlarge:not(.o-grid-listing--single-row) > *:nth-child(4) ~ *,
  .o-grid-listing--5-col\@xlarge:not(.o-grid-listing--single-row) > *:nth-child(5) ~ * {
    margin-top: #{map-get($grid-margin-tops, 'xlarge')}px;
  }

  .o-grid-listing--single-row.o-grid-listing--hide-extra\@xlarge.o-grid-listing--2-col\@xlarge > *:nth-child(2) ~ *,
  .o-grid-listing--single-row.o-grid-listing--hide-extra\@xlarge.o-grid-listing--3-col\@xlarge > *:nth-child(3) ~ *,
  .o-grid-listing--single-row.o-grid-listing--hide-extra\@xlarge.o-grid-listing--4-col\@xlarge > *:nth-child(4) ~ *,
  .o-grid-listing--single-row.o-grid-listing--hide-extra\@xlarge.o-grid-listing--4-col\@xlarge > *:nth-child(4) ~ * {
    display: none;
  }
}

@include breakpoint('xxlarge') {
  .o-grid-listing--2-col\@xxlarge > * {
    width: colspan(grid-cols-to-colspan(2), 'xxlarge');
  }

  .o-grid-listing--3-col\@xxlarge > * {
    width: colspan(grid-cols-to-colspan(3), 'xxlarge');
  }

  .o-grid-listing--4-col\@xxlarge > * {
    width: colspan(grid-cols-to-colspan(4), 'xxlarge');
  }

  .o-grid-listing--5-col\@xxlarge > * {
    width: colspan(grid-cols-to-colspan(5), 'xxlarge');
  }

  .o-grid-listing--2-col\@xxlarge:not(.o-grid-listing--single-row) > *:nth-child(2) ~ *,
  .o-grid-listing--3-col\@xxlarge:not(.o-grid-listing--single-row) > *:nth-child(3) ~ *,
  .o-grid-listing--4-col\@xxlarge:not(.o-grid-listing--single-row) > *:nth-child(4) ~ *,
  .o-grid-listing--5-col\@xxlarge:not(.o-grid-listing--single-row) > *:nth-child(5) ~ * {
    margin-top: #{map-get($grid-margin-tops, 'xxlarge')}px;
  }

  .o-grid-listing--single-row.o-grid-listing--hide-extra\@xxlarge.o-grid-listing--2-col\@xxlarge > *:nth-child(2) ~ *,
  .o-grid-listing--single-row.o-grid-listing--hide-extra\@xxlarge.o-grid-listing--3-col\@xxlarge > *:nth-child(3) ~ *,
  .o-grid-listing--single-row.o-grid-listing--hide-extra\@xxlarge.o-grid-listing--4-col\@xxlarge > *:nth-child(4) ~ *,
  .o-grid-listing--single-row.o-grid-listing--hide-extra\@xxlarge.o-grid-listing--4-col\@xxlarge > *:nth-child(4) ~ * {
    display: none;
  }
}

/***

Variants: `.o-grid-listing--gridlines-right` and `o-listing--gridlines-cols`

* `.o-grid-listing--gridlines-right` draws a line the height of the item to the right of the item
* `.o-grid-listing--gridlines-cols` draws a line the height of item plus the space between the items, adjusts item spacing and fixes the first row


***/

// draw some keylines to the right of the items
.o-grid-listing--gridlines-right > *::after,
.o-grid-listing--gridlines-cols > *::after {
  content: '';
  display: none;
  position: absolute;
  top: 0;
  bottom: 0;
  width: 1px;
  background-color: $color__rules--tertiary;
  pointer-events: none;

  @each $name, $point in $breakpoints {
    @include breakpoint('#{$name}') {
      right: colspan(1, #{$name}, 0, true);
    }
  }
}

.o-grid-listing--gridlines-right > *::after,
.o-grid-listing--single-row.o-grid-listing--gridlines-cols > *::after {
  bottom: 4px; // why? because design thats why..
}

// if following a hr and no grid lines, tweak position
hr + .o-grid-listing--gridlines-cols:not(.o-grid-listing--gridlines-top) > *::after {
  @each $name, $point in $breakpoints {
    @include breakpoint('#{$name}') {
      top: #{0 - map-get($grid-margin-tops, $name)}px;
    }
  }
}

// the last item of each row doesn't want a keyline
// cols gridlines need to stretch to reach each other
// so from the 2nd row onwards, needs a negative top spacing
@include breakpoint('small') {
  .o-grid-listing--gridlines-right.o-grid-listing--2-col\@small > *:not(:nth-child(2n))::after,
  .o-grid-listing--gridlines-right.o-grid-listing--3-col\@small > *:not(:nth-child(3n))::after,
  .o-grid-listing--gridlines-cols.o-grid-listing--2-col\@small > *:not(:nth-child(2n))::after,
  .o-grid-listing--gridlines-cols.o-grid-listing--3-col\@small > *:not(:nth-child(3n))::after {
    display: block;
  }

  .o-grid-listing--gridlines-cols.o-grid-listing--2-col\@small > *:nth-child(2) ~ *::after {
    top: #{0 - map-get($grid-margin-tops, small)}px;
  }
}

@include breakpoint('medium') {
  .o-grid-listing--gridlines-right.o-grid-listing--2-col\@medium > *:not(:nth-child(2n))::after,
  .o-grid-listing--gridlines-right.o-grid-listing--3-col\@medium > *:not(:nth-child(3n))::after,
  .o-grid-listing--gridlines-right.o-grid-listing--4-col\@medium > *:not(:nth-child(4n))::after,
  .o-grid-listing--gridlines-cols.o-grid-listing--2-col\@medium > *:not(:nth-child(2n))::after,
  .o-grid-listing--gridlines-cols.o-grid-listing--3-col\@medium > *:not(:nth-child(3n))::after,
  .o-grid-listing--gridlines-cols.o-grid-listing--4-col\@medium > *:not(:nth-child(4n))::after {
    display: block;
  }

  .o-grid-listing--gridlines-cols.o-grid-listing--2-col\@medium > *:nth-child(2) ~ *::after,
  .o-grid-listing--gridlines-cols.o-grid-listing--3-col\@medium > *:nth-child(3) ~ *::after {
    top: #{0 - map-get($grid-margin-tops, medium)}px;
  }
}

@include breakpoint('large') {
  .o-grid-listing--gridlines-right.o-grid-listing--2-col\@large > *:not(:nth-child(2n))::after,
  .o-grid-listing--gridlines-right.o-grid-listing--3-col\@large > *:not(:nth-child(3n))::after,
  .o-grid-listing--gridlines-right.o-grid-listing--4-col\@large > *:not(:nth-child(4n))::after,
  .o-grid-listing--gridlines-right.o-grid-listing--5-col\@large > *:not(:nth-child(5n))::after,
  .o-grid-listing--gridlines-cols.o-grid-listing--2-col\@large > *:not(:nth-child(2n))::after,
  .o-grid-listing--gridlines-cols.o-grid-listing--3-col\@large > *:not(:nth-child(3n))::after,
  .o-grid-listing--gridlines-cols.o-grid-listing--4-col\@large > *:not(:nth-child(4n))::after,
  .o-grid-listing--gridlines-cols.o-grid-listing--5-col\@large > *:not(:nth-child(5n))::after {
    display: block;
  }

  .o-grid-listing--gridlines-cols.o-grid-listing--2-col\@large > *:nth-child(2) ~ *::after,
  .o-grid-listing--gridlines-cols.o-grid-listing--3-col\@large > *:nth-child(3) ~ *::after,
  .o-grid-listing--gridlines-cols.o-grid-listing--4-col\@large > *:nth-child(4) ~ *::after,
  .o-grid-listing--gridlines-cols.o-grid-listing--5-col\@large > *:nth-child(5) ~ *::after {
    top: #{0 - map-get($grid-margin-tops, large)}px;
  }
}

@include breakpoint('xlarge') {
  .o-grid-listing--gridlines-right.o-grid-listing--2-col\@xlarge > *:not(:nth-child(2n))::after,
  .o-grid-listing--gridlines-right.o-grid-listing--3-col\@xlarge > *:not(:nth-child(3n))::after,
  .o-grid-listing--gridlines-right.o-grid-listing--4-col\@xlarge > *:not(:nth-child(4n))::after,
  .o-grid-listing--gridlines-right.o-grid-listing--5-col\@xlarge > *:not(:nth-child(5n))::after,
  .o-grid-listing--gridlines-cols.o-grid-listing--2-col\@xlarge > *:not(:nth-child(2n))::after,
  .o-grid-listing--gridlines-cols.o-grid-listing--3-col\@xlarge > *:not(:nth-child(3n))::after,
  .o-grid-listing--gridlines-cols.o-grid-listing--4-col\@xlarge > *:not(:nth-child(4n))::after,
  .o-grid-listing--gridlines-cols.o-grid-listing--5-col\@xlarge > *:not(:nth-child(5n))::after {
    display: block;
  }

  .o-grid-listing--gridlines-cols.o-grid-listing--2-col\@xlarge > *:nth-child(2) ~ *::after,
  .o-grid-listing--gridlines-cols.o-grid-listing--3-col\@xlarge > *:nth-child(3) ~ *::after,
  .o-grid-listing--gridlines-cols.o-grid-listing--4-col\@xlarge > *:nth-child(4) ~ *::after,
  .o-grid-listing--gridlines-cols.o-grid-listing--5-col\@xlarge > *:nth-child(5) ~ *::after {
    top: #{0 - map-get($grid-margin-tops, xlarge)}px;
  }
}

@include breakpoint('xxlarge') {
  .o-grid-listing--gridlines-right.o-grid-listing--2-col\@xxlarge > *:not(:nth-child(2n))::after,
  .o-grid-listing--gridlines-right.o-grid-listing--3-col\@xxlarge > *:not(:nth-child(3n))::after,
  .o-grid-listing--gridlines-right.o-grid-listing--4-col\@xxlarge > *:not(:nth-child(4n))::after,
  .o-grid-listing--gridlines-right.o-grid-listing--5-col\@xxlarge > *:not(:nth-child(5n))::after,
  .o-grid-listing--gridlines-cols.o-grid-listing--2-col\@xxlarge > *:not(:nth-child(2n))::after,
  .o-grid-listing--gridlines-cols.o-grid-listing--3-col\@xxlarge > *:not(:nth-child(3n))::after,
  .o-grid-listing--gridlines-cols.o-grid-listing--4-col\@xxlarge > *:not(:nth-child(4n))::after,
  .o-grid-listing--gridlines-cols.o-grid-listing--5-col\@xxlarge > *:not(:nth-child(5n))::after {
    display: block;
  }

  .o-grid-listing--gridlines-cols.o-grid-listing--2-col\@xxlarge > *:nth-child(2) ~ *::after,
  .o-grid-listing--gridlines-cols.o-grid-listing--3-col\@xxlarge > *:nth-child(3) ~ *::after,
  .o-grid-listing--gridlines-cols.o-grid-listing--4-col\@xxlarge > *:nth-child(4) ~ *::after,
  .o-grid-listing--gridlines-cols.o-grid-listing--5-col\@xxlarge > *:nth-child(5) ~ *::after {
    top: #{0 - map-get($grid-margin-tops, xxlarge)}px;
  }
}


/***

Variants: `.o-grid-listing--gridlines-top` and `o-listing--gridlines-rows`

* `.o-grid-listing--gridlines-top` draws a line the width of the item at the top of the item
* `.o-grid-listing--gridlines-rows` draws a line the width of item plus the space between the items, fixes the first and last item of each row


***/

// draw a keyline at the top of each element
.o-grid-listing--gridlines-top > *::before,
.o-grid-listing--gridlines-rows > *::before {
  content: '';
  display: none;
  position: absolute;
  left: 0;
  right: 0;
  top: 0;
  height: 1px;
  background-color: $color__rules--primary;
  pointer-events: none;
}

.o-grid-listing--gridlines-top > *::before {
  display: block;
  right: 0;
}

@each $name, $point in $breakpoints {
  @include breakpoint('#{$name}') {
    .o-grid-listing--gridlines-top > *,
    .o-grid-listing--gridlines-rows > * {
      padding-top: colspan(map-get($grid-padding-tops, $name), #{$name});
    }

    .o-grid-listing--gridlines-top:not([class*=col\@#{$name}]) > *:first-child,
    .o-grid-listing--gridlines-rows:not([class*=col\@#{$name}]) > *:first-child {
      padding-top: 0;

      &::before {
        content: '';
        display: none;
      }
    }
  }
}

// start drawing a keyline at the top of the first item in each row
// this keyline will be full width
@include breakpoint('xsmall') {
  .o-grid-listing--gridlines-rows:not([class*=col\@xsmall]) > *::before {
    display: block;
    width: colspan(58, 'xsmall');
  }
}

@include breakpoint('small') {
  .o-grid-listing--gridlines-rows:not([class*=col\@small]) > *::before,
  .o-grid-listing--gridlines-rows.o-grid-listing--2-col\@small > *:nth-child(2n + 1)::before,
  .o-grid-listing--gridlines-rows.o-grid-listing--3-col\@small > *:nth-child(3n + 1)::before {
    display: block;
    width: colspan(58, 'small');
  }
}

@include breakpoint('medium') {
  .o-grid-listing--gridlines-rows:not([class*=col\@medium]) > *::before,
  .o-grid-listing--gridlines-rows.o-grid-listing--2-col\@medium > *:nth-child(2n + 1)::before,
  .o-grid-listing--gridlines-rows.o-grid-listing--3-col\@medium > *:nth-child(3n + 1)::before,
  .o-grid-listing--gridlines-rows.o-grid-listing--4-col\@medium > *:nth-child(4n + 1)::before {
    display: block;
    width: colspan(58, 'medium');
  }
}

@include breakpoint('large') {
  .o-grid-listing--gridlines-rows:not([class*=col\@large]) > *::before,
  .o-grid-listing--gridlines-rows.o-grid-listing--2-col\@large > *:nth-child(2n + 1)::before,
  .o-grid-listing--gridlines-rows.o-grid-listing--3-col\@large > *:nth-child(3n + 1)::before,
  .o-grid-listing--gridlines-rows.o-grid-listing--4-col\@large > *:nth-child(4n + 1)::before,
  .o-grid-listing--gridlines-rows.o-grid-listing--5-col\@large > *:nth-child(5n + 1)::before {
    display: block;
    width: colspan(58, 'large');
  }
}

@include breakpoint('xlarge') {
  .o-grid-listing--gridlines-rows:not([class*=col\@xlarge]) > *::before,
  .o-grid-listing--gridlines-rows.o-grid-listing--2-col\@xlarge > *:nth-child(2n + 1)::before,
  .o-grid-listing--gridlines-rows.o-grid-listing--3-col\@xlarge > *:nth-child(3n + 1)::before,
  .o-grid-listing--gridlines-rows.o-grid-listing--4-col\@xlarge > *:nth-child(4n + 1)::before,
  .o-grid-listing--gridlines-rows.o-grid-listing--5-col\@xlarge > *:nth-child(5n + 1)::before {
    display: block;
    width: colspan(58, 'xlarge');
  }
}

@include breakpoint('xxlarge') {
  .o-grid-listing--gridlines-rows:not([class*=col\@xxlarge]) > *::before,
  .o-grid-listing--gridlines-rows.o-grid-listing--2-col\@xxlarge > *:nth-child(2n + 1)::before,
  .o-grid-listing--gridlines-rows.o-grid-listing--3-col\@xxlarge > *:nth-child(3n + 1)::before,
  .o-grid-listing--gridlines-rows.o-grid-listing--4-col\@xxlarge > *:nth-child(4n + 1)::before,
  .o-grid-listing--gridlines-rows.o-grid-listing--5-col\@xxlarge > *:nth-child(5n + 1)::before {
    display: block;
    width: colspan(58, 'xxlarge');
  }
}


// Gridlines in 2 directions need some fixing
// adjust the top position of the vertical gridlines when right hand lines are used with top or rows
.o-grid-listing--gridlines-right.o-grid-listing--gridlines-top > *::after,
.o-grid-listing--gridlines-right.o-grid-listing--gridlines-rows > *::after {
  @each $name, $point in $breakpoints {
    @include breakpoint('#{$name}') {
      top: colspan(map-get($grid-padding-tops, $name), #{$name});
    }
  }
}

// adjust the bottom position of the vertical gridlines when cols lines are used with top or rows
// starts off easy
.o-grid-listing--gridlines-cols.o-grid-listing--gridlines-rows > *::after {
  @each $name, $point in $breakpoints {
    @include breakpoint('#{$name}') {
      bottom: #{0 - map-get($grid-margin-tops, $name)}px;
    }
  }
}

// then you have to select the last row of everything and fix
@include breakpoint('small') {
  .o-grid-listing--gridlines-cols.o-grid-listing--gridlines-rows.o-grid-listing--2-col\@small > *:nth-child(2n+1):nth-last-child(-n+2)::after,
  .o-grid-listing--gridlines-cols.o-grid-listing--gridlines-rows.o-grid-listing--2-col\@small > *:nth-child(2n+1):nth-last-child(-n+2) ~ *::after,
  .o-grid-listing--gridlines-cols.o-grid-listing--gridlines-rows.o-grid-listing--3-col\@small > *:nth-child(3n+1):nth-last-child(-n+3)::after,
  .o-grid-listing--gridlines-cols.o-grid-listing--gridlines-rows.o-grid-listing--3-col\@small > *:nth-child(3n+1):nth-last-child(-n+3) ~ *::after, {
    bottom: 0;
  }
}

@include breakpoint('medium') {
  .o-grid-listing--gridlines-cols.o-grid-listing--gridlines-rows.o-grid-listing--2-col\@medium > *:nth-child(2n+1):nth-last-child(-n+2)::after,
  .o-grid-listing--gridlines-cols.o-grid-listing--gridlines-rows.o-grid-listing--2-col\@medium > *:nth-child(2n+1):nth-last-child(-n+2) ~ *::after,
  .o-grid-listing--gridlines-cols.o-grid-listing--gridlines-rows.o-grid-listing--3-col\@medium > *:nth-child(3n+1):nth-last-child(-n+3)::after,
  .o-grid-listing--gridlines-cols.o-grid-listing--gridlines-rows.o-grid-listing--3-col\@medium > *:nth-child(3n+1):nth-last-child(-n+3) ~ *::after,
  .o-grid-listing--gridlines-cols.o-grid-listing--gridlines-rows.o-grid-listing--4-col\@medium > *:nth-child(4n+1):nth-last-child(-n+4)::after,
  .o-grid-listing--gridlines-cols.o-grid-listing--gridlines-rows.o-grid-listing--4-col\@medium > *:nth-child(4n+1):nth-last-child(-n+4) ~ *::after {
    bottom: 0;
  }
}

@include breakpoint('large') {
  .o-grid-listing--gridlines-cols.o-grid-listing--gridlines-rows.o-grid-listing--2-col\@large > *:nth-child(2n+1):nth-last-child(-n+2)::after,
  .o-grid-listing--gridlines-cols.o-grid-listing--gridlines-rows.o-grid-listing--2-col\@large > *:nth-child(2n+1):nth-last-child(-n+2) ~ *::after,
  .o-grid-listing--gridlines-cols.o-grid-listing--gridlines-rows.o-grid-listing--3-col\@large > *:nth-child(3n+1):nth-last-child(-n+3)::after,
  .o-grid-listing--gridlines-cols.o-grid-listing--gridlines-rows.o-grid-listing--3-col\@large > *:nth-child(3n+1):nth-last-child(-n+3) ~ *::after,
  .o-grid-listing--gridlines-cols.o-grid-listing--gridlines-rows.o-grid-listing--4-col\@large > *:nth-child(4n+1):nth-last-child(-n+4)::after,
  .o-grid-listing--gridlines-cols.o-grid-listing--gridlines-rows.o-grid-listing--4-col\@large > *:nth-child(4n+1):nth-last-child(-n+4) ~ *::after,
  .o-grid-listing--gridlines-cols.o-grid-listing--gridlines-rows.o-grid-listing--5-col\@large > *:nth-child(5n+1):nth-last-child(-n+5)::after,
  .o-grid-listing--gridlines-cols.o-grid-listing--gridlines-rows.o-grid-listing--5-col\@large > *:nth-child(5n+1):nth-last-child(-n+5) ~ *::after {
    bottom: 0;
  }
}

@include breakpoint('xlarge') {
  .o-grid-listing--gridlines-cols.o-grid-listing--gridlines-rows.o-grid-listing--2-col\@xlarge > *:nth-child(2n+1):nth-last-child(-n+2)::after,
  .o-grid-listing--gridlines-cols.o-grid-listing--gridlines-rows.o-grid-listing--2-col\@xlarge > *:nth-child(2n+1):nth-last-child(-n+2) ~ *::after,
  .o-grid-listing--gridlines-cols.o-grid-listing--gridlines-rows.o-grid-listing--3-col\@xlarge > *:nth-child(3n+1):nth-last-child(-n+3)::after,
.o-grid-listing--gridlines-cols.o-grid-listing--gridlines-rows.o-grid-listing--3-col\@xlarge > *:nth-child(3n+1):nth-last-child(-n+3) ~ *::after,
  .o-grid-listing--gridlines-cols.o-grid-listing--gridlines-rows.o-grid-listing--4-col\@xlarge > *:nth-child(4n+1):nth-last-child(-n+4)::after,
  .o-grid-listing--gridlines-cols.o-grid-listing--gridlines-rows.o-grid-listing--4-col\@xlarge > *:nth-child(4n+1):nth-last-child(-n+4) ~ *::after,
  .o-grid-listing--gridlines-cols.o-grid-listing--gridlines-rows.o-grid-listing--5-col\@xlarge > *:nth-child(5n+1):nth-last-child(-n+5)::after,
  .o-grid-listing--gridlines-cols.o-grid-listing--gridlines-rows.o-grid-listing--5-col\@xlarge > *:nth-child(5n+1):nth-last-child(-n+5) ~ *::after {
    bottom: 0;
  }
}

@include breakpoint('xxlarge') {
  .o-grid-listing--gridlines-cols.o-grid-listing--gridlines-rows.o-grid-listing--2-col\@xxlarge > *:nth-child(2n+1):nth-last-child(-n+2)::after,
  .o-grid-listing--gridlines-cols.o-grid-listing--gridlines-rows.o-grid-listing--2-col\@xxlarge > *:nth-child(2n+1):nth-last-child(-n+2) ~ *::after,
  .o-grid-listing--gridlines-cols.o-grid-listing--gridlines-rows.o-grid-listing--3-col\@xxlarge > *:nth-child(3n+1):nth-last-child(-n+3)::after,
  .o-grid-listing--gridlines-cols.o-grid-listing--gridlines-rows.o-grid-listing--3-col\@xxlarge > *:nth-child(3n+1):nth-last-child(-n+3) ~ *::after,
  .o-grid-listing--gridlines-cols.o-grid-listing--gridlines-rows.o-grid-listing--4-col\@xxlarge > *:nth-child(4n+1):nth-last-child(-n+4)::after,
  .o-grid-listing--gridlines-cols.o-grid-listing--gridlines-rows.o-grid-listing--4-col\@xxlarge > *:nth-child(4n+1):nth-last-child(-n+4) ~ *::after,
  .o-grid-listing--gridlines-cols.o-grid-listing--gridlines-rows.o-grid-listing--5-col\@xxlarge > *:nth-child(5n+1):nth-last-child(-n+5)::after,
  .o-grid-listing--gridlines-cols.o-grid-listing--gridlines-rows.o-grid-listing--5-col\@xxlarge > *:nth-child(5n+1):nth-last-child(-n+5) ~ *::after {
    bottom: 0;
  }
}

