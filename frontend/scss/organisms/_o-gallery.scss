
.o-gallery {
  @include background-fill;
  padding-top: .02px;
  background-color: $color__bg--gallery;
  color: $color__text--contrast;
  transform: translateZ(0);

  @include breakpoint('xlarge') {
    display: flex;
    flex-flow: row wrap;
    align-items: flex-start;
  }
}

.o-gallery__title {
  @include breakpoint('medium+') {
    padding-right: 50%;
  }

  @include breakpoint('xlarge') {
    flex: 0 0 auto;
    width: 100%;
  }
}

.o-gallery__caption {
  position: relative;
  margin-top: 32px;

  @include breakpoint('small+') {
    margin-top: 36px;
  }

  @include breakpoint('medium+') {
    margin-top: 40px;
  }

  @include breakpoint('xlarge') {
    flex: 0 0 auto;
    width: colspan(13, xlarge);
  }
}

.o-gallery__media {
  position: relative;
  margin-top: 40px;

  @include breakpoint('xlarge') {
    flex: 0 0 auto;
    width: colspan(43, xlarge);
    margin-left: colspan(2, xlarge);
  }
}

.o-gallery__title,
.o-gallery figcaption strong,
.o-gallery .m-media figcaption strong.f-caption {
  color: $color__text--title-contrast;
}

.o-gallery hr,
.o-gallery .hr {
  margin-top: 0;
  border-top-color: $color__rules--contrast;
}

.o-gallery__all-link {
  display: none;
  position: absolute;
  right: 0;
  top: 44px;
  margin-top: 0;

  @include breakpoint('medium+') {
    display: block;
  }
}

.o-gallery__all-link-btn {
  margin-top: 0;
  padding-bottom: 32px;

  @include breakpoint('medium+') {
    display: none;
  }
}

.o-gallery__all-link-btn .btn {
  display: block;
  width: 100%;
}

.o-gallery__caption p {
  @include breakpoint('small+') {
    padding-right: colspan(8, small);
  }

  @include breakpoint('medium+') {
    padding-right: colspan(28, medium);
  }

  @include breakpoint('large+') {
    padding-right: colspan(28, large);
  }

  @include breakpoint('xlarge') {
    padding-right: 0;
  }
}

.o-gallery__share {
  display: block;
  margin-top: 20px;

  @include breakpoint('small+') {
    position: absolute;
    right: 0;
    top: 12px;
    margin-top: 0;
  }

  @include breakpoint('xlarge') {
    position: static;
    margin-top: 24px;
  }
}


.o-gallery__media .m-media__img {
  background: transparent;
}


.o-gallery__title.f-module-title-2 {
  @include tucked-margin-top($f-module-title-2, ('xsmall': 56, 'small+': 68, 'medium+': 80));
}

.o-gallery__caption .f-caption {
  @include tucked-margin-top($f-caption, ('xsmall': 24));
}


.o-gallery--mosaic {

  .o-gallery__media {
    padding-bottom: 56px;

    @include breakpoint('small+') {
      display: flex;
      flex-flow: row wrap;
      align-items: flex-start;
      justify-content: space-between;
      padding-bottom: 64px - 48px;
    }

    @include breakpoint('medium+') {
      padding-bottom: 84px - 48px;
      column-gap: colspan(2, medium);
    }

    @include breakpoint('large+') {
      column-gap: colspan(2, large);
    }

    @include breakpoint('xlarge') {
      column-gap: colspan(1, xlarge);
    }
  }

  .o-gallery__media > * {
    margin-top: 48px;

    @include breakpoint('small+') {
      left: 0;
      top: 0;
      flex: 0 0 auto;
      width: colspan(28, small);
      opacity: 0;
      transition: opacity .25s;
    }

    @include breakpoint('medium+') {
      width: colspan(28, medium);
    }

    @include breakpoint('large+') {
      width: colspan(28, large);
    }

    @include breakpoint('xlarge') {
      width: colspan(21, xlarge);
    }
  }

  .o-gallery__media > *.s-positioned {
    position: absolute;
    z-index: 1;
    flex: none;
    opacity: 1;
    transition: opacity .25s, top .4s $bezier--marius-mosaic, left .4s $bezier--marius-mosaic, height .4s $bezier--marius-mosaic;
  }

  .o-gallery__media > *.s-positioned:not(.s-repositioning) {
    margin-top: 0;
  }

  .o-gallery__media > *:nth-child(1) { transition-delay: .1s; }
  .o-gallery__media > *:nth-child(2) { transition-delay: .2s; }
  .o-gallery__media > *:nth-child(3) { transition-delay: .3s; }
  .o-gallery__media > *:nth-child(4) { transition-delay: .4s; }
  .o-gallery__media > *:nth-child(5) { transition-delay: .5s; }
  .o-gallery__media > *:nth-child(6) { transition-delay: .6s; }
  .o-gallery__media > *:nth-child(7) { transition-delay: .7s; }
  .o-gallery__media > *:nth-child(7) ~ * { transition-delay: .8s; }

  .m-media__img img {
    max-height: #{colspan(58, xsmall) * 4/3};
    object-fit: contain;

    @include breakpoint('small+') {
      max-height: #{colspan(28, small) * 4/3};
    }

    @include breakpoint('medium+') {
      max-height: #{colspan(28, medium) * 4/3};
    }

    @include breakpoint('large+') {
      max-height: #{colspan(28, large) * 4/3};
    }

    @include breakpoint('xlarge') {
      max-height: #{colspan(21, xlarge) * 4/3};
    }
  }

  .o-gallery__all-link-btn {
    margin-top: -28px;

    @include breakpoint('small+') {
      margin-top: -32px;
    }
  }
}


.o-gallery--slider {
  padding-bottom: .02px;

  .o-gallery__media {
    display: flex;
    flex-flow: row nowrap;
    margin-right: colspan(3, xsmall, 0, true);
    margin-bottom: 24px;
    margin-left: colspan(3, xsmall, 0, true);
    padding-bottom: 32px;
    padding-left: colspan(2, xsmall);
    overflow-x: auto;
    overflow-y: hidden;

    @include breakpoint('small+') {
      margin-right: colspan(3, small, 0, true);
      margin-bottom: 32px;
      margin-left: colspan(3, small, 0, true);
      padding-left: colspan(2, small);
    }

    @include breakpoint('medium+') {
      margin-right: colspan(3, medium, 0, true);
      margin-bottom: 52px;
      margin-left: colspan(3, medium, 0, true);
      padding-left: colspan(2, medium);
    }

    @include breakpoint('large+') {
      margin-right: colspan(3, large, 0, true);
      margin-left: colspan(3, large, 0, true);
      padding-left: colspan(2, large);
    }

    @include breakpoint('xlarge') {
      width: colspan(46, xlarge);
      margin-right: colspan(3, xlarge, 0, true);
      margin-left: colspan(2, xlarge);
      padding-left: 0;
    }

    &::after {
      content: '';
      display: block;
      flex: 0 0 auto;
      width: colspan(3, xsmall);
      height: 1px;

      @include breakpoint('small+') {
        width: colspan(3, small);
      }

      @include breakpoint('medium+') {
        width: colspan(3, medium);
      }

      @include breakpoint('large+') {
        width: colspan(3, large);
      }

      @include breakpoint('xlarge') {
        //width: colspan(3, xlarge);
        width: calc((100vw - #{map-get($main-col-widths, xlarge)}) / 2);
      }
    }
  }

  .o-gallery__media > * {
    flex: 0 0 auto;
    width: colspan(50, xsmall);
    margin-top: 0;
    margin-left: colspan(2, xsmall);

    @include breakpoint('small+') {
      width: colspan(35, small);
      margin-left: colspan(1, small);
    }

    @include breakpoint('medium+') {
      width: colspan(23, medium);
      margin-left: colspan(1, medium);
    }

    @include breakpoint('large+') {
      width: colspan(23, large);
      margin-left: colspan(1, large);
    }

    @include breakpoint('xlarge') {
      width: colspan(18, xlarge);
      margin-left: colspan(1, xlarge);

      &:first-child {
        margin-left: 0;
      }
    }
  }

  .m-media__img img {
    max-height: 400px;
    object-fit: contain;
    object-position: center top;

    @include breakpoint('small+') {
      max-height: 480px;
    }

    @include breakpoint('xlarge') {
      max-height: #{colspan(21, xlarge) * 4/3};
    }
  }

  .m-media__img video,
  .m-media__img embed,
  .m-media__img iframe,
  .m-media__img object {
    height: colspan(50, xsmall) * 9/16;

    @include breakpoint('small+') {
      height: colspan(35, small) * 9/16;
    }

    @include breakpoint('medium+') {
      height: colspan(23, medium) * 9/16;
    }

    @include breakpoint('large+') {
      height: colspan(23, medium) * 9/16;
    }

    @include breakpoint('xlarge') {
      height: #{colspan(18, xlarge) * 9/16};
    }
  }

  .o-gallery__all-link-btn {
    margin-top: -24px;

    @include breakpoint('small+') {
      margin-top: -32px;
    }
  }
}
