
/*****************************/
/*
/* Sort out text spacings
/*
/**/

.o-blocks__text-block > .f-deck {
  @include tucked-margin-top($f-deck, ('xsmall': 84));

  &:first-child {
    @include tucked-align-top($f-deck);
  }
}

/*****/

.o-blocks__text-block > h4:not([class*=f-]),
.o-blocks__text-block > .f-module-title-2 {
  @include tucked-margin-top($f-module-title-2, ('xsmall': 68));

  &:first-child {
    @include tucked-align-top($f-module-title-2);
  }
}

.o-blocks__text-block > h4:not([class*=f-]) {
  @extend %f-module-title-2;
}

.o-blocks__text-block > .f-deck + h4:not([class*=f-]),
.o-blocks__text-block > .f-deck + .f-module-title-2 {
  @include tucked-margin-top($f-module-title-2, ('xsmall': 76));
}

/*****/

.o-blocks__text-block > h5:not([class*=f-]),
.o-blocks__text-block > .f-subheading-1 {
  @include tucked-margin-top($f-subheading-1, ('xsmall': 56));

  &:first-child {
    @include tucked-align-top($f-subheading-1);
  }
}

.o-blocks__text-block > h5:not([class*=f-]) {
  @extend %f-subheading-1;
}

.o-blocks__text-block > .hr + h5:not([class*=f-]),
.o-blocks__text-block > .hr + .f-subheading-1 {
  @include tucked-margin-top($f-subheading-1, ('xsmall': 36));
}

.o-blocks__text-block > .f-deck + h5:not([class*=f-]),
.o-blocks__text-block > .f-deck + .f-subheading-1 {
  @include tucked-margin-top($f-subheading-1, ('xsmall': 76));
}

/*****/

.o-blocks__text-block > .f-list-2 {
  @include tucked-margin-top($f-list-2, ('xsmall': 56));

  &:first-child {
    @include tucked-align-top($f-list-2);
  }
}

/*****/

.o-blocks__text-block > .f-list-3 {
  @include tucked-margin-top($f-list-3, ('xsmall': 56));

  &:first-child {
    @include tucked-align-top($f-list-3);
  }
}

/*****/

.o-blocks__text-block > .f-list-4 {
  @include tucked-margin-top($f-list-4, ('xsmall': 56));

  &:first-child {
    @include tucked-align-top($f-list-4);
  }
}

/*****/

.o-blocks__text-block > .f-list-5 {
  @include tucked-margin-top($f-list-5, ('xsmall': 56));

  &:first-child {
    @include tucked-align-top($f-list-5);
  }
}

/*****/

.o-blocks__text-block > p:not([class*=f-]),
.o-blocks__text-block > ul:not([class*=f-]):not([class*=o-]):not([class*=m-]),
.o-blocks__text-block > ol:not([class*=f-]):not([class*=o-]):not([class*=m-]),
.o-blocks__text-block > .f-body {
  @include tucked-margin-top($f-body, ('xsmall': 56));

  &:first-child {
    @include tucked-align-top($f-body);
  }
}

.o-blocks__text-block > p:not([class*=f-]),
.o-blocks__text-block > ul:not([class*=f-]):not([class*=o-]):not([class*=m-]),
.o-blocks__text-block > ol:not([class*=f-]):not([class*=o-]):not([class*=m-]) {
  @extend %f-body;
}

.o-blocks__text-block > ul:not([class*=f-]):not([class*=o-]):not([class*=m-]),
.o-blocks__text-block > ol:not([class*=f-]):not([class*=o-]):not([class*=m-]) {
  @extend .list;
}

.o-blocks__text-block > .f-deck + p:not([class*=f-]),
.o-blocks__text-block > .f-deck + ul:not([class*=f-]):not([class*=o-]):not([class*=m-]),
.o-blocks__text-block > .f-deck + ol:not([class*=f-]):not([class*=o-]):not([class*=m-]),
.o-blocks__text-block > .f-deck + .f-body {
  @include tucked-margin-top($f-body, ('xsmall': 76));
}

/*****/

.o-article--editorial .o-blocks__text-block > p:not([class*=f-]),
.o-blocks__text-block > .f-body-editorial,
.o-blocks__text-block > p:not([class*=f-]),
.o-blocks__text-block > .f-body-editorial {
  @include tucked-margin-top($f-body-editorial, ('xsmall': 56));

  &:first-child {
    @include tucked-align-top($f-body-editorial);
  }
}

.o-article--editorial .o-blocks__text-block > p:not([class*=f-]),
.o-article--editorial .o-blocks__text-block > ul:not([class*=f-]):not([class*=o-]):not([class*=m-]),
.o-article--editorial .o-blocks__text-block > ol:not([class*=f-]):not([class*=o-]):not([class*=m-]) {
  @extend %f-body-editorial;
}

.o-article--editorial .o-blocks.o-article__body .o-blocks__text-block  > p:not([class*=f-]) .f-dropcap-editorial {
  float: left;
  margin-top: -17px;
  margin-right: 4px;

  @include breakpoint('small+') {
    margin-top: -9px;
  }

  @include breakpoint('large+') {
    margin-top: -34px;
    margin-bottom: -4px;
  }
}

/*****/

.o-blocks__text-block > small,
.o-blocks__text-block > .f-secondary {
  @include tucked-margin-top($f-secondary, ('xsmall': 48));

  &:first-child {
    @include tucked-align-top($f-secondary);
  }
}

.o-blocks__text-block > small {
  @extend %f-secondary;
}

/*****************************/
/*
/* Special text spacings
/*
/**/

.o-blocks__text-block > h5:not([class*=f-]) + p:not([class*=f-]),
.o-blocks__text-block > .f-subheading-1 + .f-body,
.o-blocks__text-block > .f-subheading-1 + .f-body-editorial {
  margin-top: 0;
}

.o-blocks__text-block > p:not([class*=f-]),
.o-blocks__text-block > h4:not([class*=f-]),
.o-blocks__text-block > h5:not([class*=f-]),
.o-blocks__text-block > *[class*=f-] .f-link {
  //@include untuck;
}

.o-blocks__text-block > p:not([class*=f-]),
.o-blocks__text-block > .f-deck,
.o-blocks__text-block > .f-body,
.o-blocks__text-block > .f-body-editorial {
  padding-right: colspan(2, xsmall);

  @include breakpoint('small+') {
    padding-right: colspan(3, small);
  }

  @include breakpoint('medium+') {
    padding-right: 0;
  }
}

/*****************************/
/*
/* Basic block spaicng
/*
/**/

.o-blocks {
  .o-blocks__block,
  .o-blocks__text-block,
  .hr {
    clear: left;
    margin-top: 32px;

    @include breakpoint('small+') {
      margin-top: 44px;
    }

    @include breakpoint('medium+') {
      margin-top: 60px;
    }
  }

  .o-blocks__text-block {
    padding-top: .02px;
    padding-bottom: .02px;
  }

  .o-blocks__block:first-child,
  .o-blocks__text-block:first-child,
  .hr:first-child {
    margin-top: 0;

    @include breakpoint('small+') {
      margin-top: 0;
    }

    @include breakpoint('medium+') {
      margin-top: 0;
    }
  }
}

/*****************************/
/*
/* Some blocks have special widths/spacings
/*
/**/

.o-blocks {

  .o-gallery,
  .m-media--m,
  .m-media--l,
  .m-cta-banner,
  .m-aside-newsletter--wide {
    @include breakpoint('medium+') {
      width: colspan(58, medium);
      margin-right: colspan(20, medium, 0, true);
    }

    @include breakpoint('large+') {
      width: colspan(58, large);
      margin-right: 0;
      margin-left: colspan(15, large, 0, true);
    }

    @include breakpoint('xlarge') {
      width: colspan(58, xlarge);
      margin-left: colspan(15, xlarge, 0, true);
    }
  }

  .m-media--m {
    @include breakpoint('large+') {
      display: flex;
      flex-flow: row-reverse nowrap;
    }
  }

  .m-media--m .m-media__img {
    @include breakpoint('large+') {
      flex: 0 0 auto;
      width: colspan(43, large);
    }

    @include breakpoint('xlarge') {
      width: colspan(43, xlarge);
    }
  }

  .m-media--m figcaption {
    @include breakpoint('large+') {
      flex: 0 0 auto;
      width: colspan(15, large);
      margin-top: 0;
      padding-right: colspan(2, large);

      &::before {
        content: '';
        position: absolute;
        left: 0;
        top: 0;
        width: colspan(13, large);
        height: 1px;
        background-color: $color__rules--primary;
      }
    }

    @include breakpoint('xlarge') {
      width: colspan(15, xlarge);
      padding-right: colspan(2, xlarge);

      &::before {
        width: colspan(13, xlarge);
      }
    }
  }

  .m-media--m figcaption .f-caption {
    @include breakpoint('large+') {
      @include tucked-align-top($f-caption, 'large');
    }

    @include breakpoint('xlarge') {
      @include tucked-align-top($f-caption, 'xlarge');
    }
  }

  .m-media--m .m-media__share {
    @include breakpoint('large+') {
      display: block;
      position: static;
      margin-top: 24px;
    }
  }

  .m-inline-aside {
    @include breakpoint('small') {
      float: right;
      clear: both;
      width: colspan(23, small);
      margin-bottom: colspan(3, small);
      margin-left: colspan(3, small);
    }
  }
}

/*****************************/
/*
/* Lets get the links styled in o-blocks__text-block
/*
/**/

.o-blocks__text-block > p:not([class*=f-]) a:not(.btn),
.o-blocks__text-block > ul:not([class*=f-]):not([class*=o-]):not([class*=m-]) a:not(.btn),
.o-blocks__text-block > ol:not([class*=f-]):not([class*=o-]):not([class*=m-]) a:not(.btn),
.o-blocks__text-block > .f-body a:not(.btn) {
  @include text-underline(1.02em, $color__rules--secondary);
  color: $color__link--accent;
  text-decoration: none;

  &:hover,
  &:focus:hover {
    @include text-underline(1.02em, $color__link--accent);
  }

  &:active:hover {
    @include text-underline(1.02em, $color__rules--secondary);
  }
}

.o-article--editorial .o-blocks__text-block > p:not([class*=f-]) a,
.o-article--editorial .o-blocks__text-block > ul:not([class*=f-]):not([class*=o-]):not([class*=m-]) a,
.o-article--editorial .o-blocks__text-block > ol:not([class*=f-]):not([class*=o-]):not([class*=m-]) a,
.o-blocks__text-block > .f-body-editorial a {
  @include text-underline(.82em, $color__rules--secondary);
  color: $color__link--editorial;
  text-decoration: none;

  &:hover,
  &:focus:hover {
    @include text-underline(.82em, $color__link--editorial);
  }

  &:active:hover {
    @include text-underline(.82em, $color__rules--secondary);
  }
}

.o-blocks__text-block > .f-deck a {
  @include text-underline(.82em, $color__text--tertiary);
  color: inherit;
  text-decoration: none;

  &:hover,
  &:focus:hover {
    @include text-underline(.82em, $color__text--secondary);
    color: $color__text;
  }

  &:active:hover {
    color: $color__text;
  }
}

.o-blocks__text-block > small a,
.o-blocks__text-block > .f-secondary a {
  @include text-underline(1.02em, $color__text--tertiary);

  &:hover,
  &:focus:hover {
    @include text-underline(1.02em, $color__text--secondary);
  }

  &:active {
    @include text-underline(1.02em, transparent);
  }
}

.o-blocks__text-block > p:not([class*=f-]) sub,
.o-blocks__text-block > p:not([class*=f-]) sup,
.o-blocks__text-block > ul:not([class*=f-]):not([class*=o-]):not([class*=m-]) sub,
.o-blocks__text-block > ol:not([class*=f-]):not([class*=o-]):not([class*=m-]) sup,
.o-blocks__text-block > ul:not([class*=f-]):not([class*=o-]):not([class*=m-]) sub,
.o-blocks__text-block > ol:not([class*=f-]):not([class*=o-]):not([class*=m-]) sup,
.o-blocks__text-block > .f-body sub,
.o-blocks__text-block > .f-body sup,
.o-blocks__text-block > .f-body-editorial sub,
.o-blocks__text-block > .f-body-editorial sup {
  font-size: 60%;
}

.o-blocks__text-block > p:not([class*=f-]) sub a,
.o-blocks__text-block > p:not([class*=f-]) sup a,
.o-blocks__text-block > ul:not([class*=f-]):not([class*=o-]):not([class*=m-]) sub a,
.o-blocks__text-block > ol:not([class*=f-]):not([class*=o-]):not([class*=m-]) sup a,
.o-blocks__text-block > ul:not([class*=f-]):not([class*=o-]):not([class*=m-]) sub a,
.o-blocks__text-block > ol:not([class*=f-]):not([class*=o-]):not([class*=m-]) sup a,
.o-blocks__text-block > .f-body sub a,
.o-blocks__text-block > .f-body sup a,
.o-blocks__text-block > .f-body-editorial sub a,
.o-blocks__text-block > .f-body-editorial sup a {
  text-decoration: none !important;
  background: none !important;
}
